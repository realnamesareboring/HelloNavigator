---
layout: challenge
title: "Space Pirate Password Breach"
module_name: "Identity Defense Grid"
challenge_number: 1
total_challenges: 4
progress_percent: 25
xp_reward: 150
difficulty: "Beginner"
difficulty_stars: 2
workspace_icon: "üîê"
workspace_name: "Security Terminal"
workspace_mode: "Investigation"

xis_message: "Navigator! We've intercepted a data dump from the space pirates who attacked our ship. The file contains crew passwords from a compromised outpost. We need to analyze their security practices and find the master access code they're using to infiltrate other systems!"

mission_brief: |
  **URGENT SECURITY BREACH ANALYSIS**
  
  The space pirates have compromised the Kepler Station outpost and stolen crew credentials. Your mission:
  
  - Analyze the intercepted password database
  - Identify security vulnerabilities in their password policies
  - Find patterns that reveal the pirates' master access strategy
  - Extract the flag that proves you've uncovered their method

objectives:
  - "Download and examine the intercepted password file"
  - "Identify the 3 most common weak password patterns"
  - "Find the admin account with the weakest password"
  - "Discover the hidden master access code pattern"
  - "Submit the flag in format: NAVIGATOR{...}"

available_hints: 4

available_tools:
  - id: "password-analyzer"
    name: "Password Analyzer"
    icon: "üîç"
  - id: "pattern-detector"
    name: "Pattern Detector" 
    icon: "üéØ"
  - id: "text-processor"
    name: "Text Processor"
    icon: "üìù"

# ADD: Evidence Files to the existing resources section  
resources:
  - name: "üìÑ crew_passwords.txt (2.1 KB)"
    url: "#"
    icon: "üîê"
    type: "evidence"
  - name: "Password Security Guide"
    url: "https://pages.nist.gov/800-63-3/"
    icon: "üìñ"
  - name: "Common Password Attacks"
    url: "#"
    icon: "‚ö†Ô∏è"
  - name: "Security Best Practices"
    url: "#"
    icon: "‚úÖ"
---

<!-- This content goes into the CENTER workspace panel -->
<div class="password-breach-challenge">
    <div class="challenge-briefing">
        <h3>üö® Emergency Briefing</h3>
        <p>
            <strong>Intelligence Report:</strong> Space pirates breached Kepler Station using a coordinated attack. 
            We've recovered their data dump containing <code>crew_passwords.txt</code>.
        </p>
        
        <div class="investigation-steps">
            <h4>üîç Investigation Protocol</h4>
            <ol>
                <li><strong>Download Evidence:</strong> Use the evidence file in the Resources panel (right)</li>
                <li><strong>Examine Data:</strong> Use <code>cat crew_passwords.txt</code> in the terminal</li>
                <li><strong>Search Patterns:</strong> Use commands like <code>grep admin crew_passwords.txt</code></li>
                <li><strong>Analyze Security:</strong> Try <code>analyze crew_passwords.txt</code></li>
                <li><strong>Find the Flag:</strong> Look for the hidden NAVIGATOR{...} pattern</li>
                <li><strong>Submit:</strong> Use <code>submit NAVIGATOR{your_flag}</code></li>
            </ol>
        </div>
    </div>
    
    <!-- Terminal will be loaded here by the framework -->
    <div class="workspace-hint">
        <p>üí° <strong>Start Here:</strong> Click the evidence file in the Resources panel (right), then use <code>cat crew_passwords.txt</code> in the terminal!</p>
    </div>
</div>

<style>
/* Work WITH the existing framework, don't override it */
.password-breach-challenge {
    padding: 1rem;
}

.challenge-briefing {
    background: rgba(0, 30, 60, 0.8);
    border: 2px solid #00ffff;
    clip-path: polygon(0 0, calc(100% - 15px) 0, 100% 15px, 100% 100%, 15px 100%, 0 calc(100% - 15px));
    padding: 1.5rem;
    backdrop-filter: blur(10px);
    margin-bottom: 1rem;
}

.challenge-briefing h3 {
    color: #ff8000;
    font-family: 'Orbitron', sans-serif;
    margin-bottom: 1rem;
    text-shadow: 0 0 5px #ff8000;
}

.challenge-briefing h4 {
    color: #00ffff;
    font-family: 'Orbitron', sans-serif;
    margin: 1.5rem 0 0.5rem 0;
    font-size: 1rem;
}

.challenge-briefing p, .challenge-briefing li {
    color: #00ffff;
    font-size: 0.9rem;
    line-height: 1.4;
    margin-bottom: 0.75rem;
}

.challenge-briefing ol {
    margin: 0.5rem 0;
    padding-left: 1.5rem;
}

.investigation-steps {
    background: rgba(0, 255, 255, 0.05);
    border: 1px solid #00ffff;
    border-radius: 8px;
    padding: 1rem;
    margin: 1rem 0;
}

.workspace-hint {
    background: rgba(255, 255, 0, 0.1);
    border: 1px solid #ffff00;
    border-radius: 4px;
    padding: 0.75rem;
    margin-top: 1rem;
}

.workspace-hint p {
    color: #ffff00;
    font-size: 0.9rem;
    margin: 0;
}

code {
    background: rgba(0, 255, 255, 0.2);
    color: #00ffff;
    padding: 0.2rem 0.4rem;
    border-radius: 3px;
    font-family: 'Share Tech Mono', monospace;
}

/* Style evidence links in the resources panel */
.resource-link[href="#"] {
    cursor: pointer;
}

.resource-link[href="#"]:hover {
    background: rgba(255, 128, 0, 0.1);
    border-color: #ff8000;
}
</style>

<script>
// Enhance the existing resources section to handle evidence downloads
document.addEventListener('DOMContentLoaded', function() {
    // Find evidence resource links and make them downloadable
    const resourceLinks = document.querySelectorAll('.resource-link');
    
    resourceLinks.forEach(link => {
        const text = link.textContent.trim();
        
        // Check if this is the evidence file
        if (text.includes('crew_passwords.txt')) {
            // Make it downloadable instead of a regular link
            link.addEventListener('click', function(e) {
                e.preventDefault();
                downloadEvidenceFile('crew_passwords.txt');
            });
            
            // Add visual indicator
            link.style.background = 'linear-gradient(135deg, rgba(255, 128, 0, 0.2), rgba(204, 102, 0, 0.2))';
            link.style.borderColor = '#ff8000';
            
            // Add download status
            const statusSpan = document.createElement('span');
            statusSpan.textContent = ' ‚¨áÔ∏è';
            statusSpan.className = 'download-status';
            link.appendChild(statusSpan);
        }
    });
});

function downloadEvidenceFile(filename) {
    console.log('üìÅ Download initiated for:', filename);
    
    // Find the evidence link and add visual feedback
    const evidenceLink = document.querySelector('.resource-link[href="#"]');
    const statusSpan = evidenceLink?.querySelector('.download-status');
    
    if (statusSpan) {
        statusSpan.textContent = ' ‚è≥';
        evidenceLink.style.opacity = '0.7';
    }
    
    // Use your existing dynamic challenge engine or fallback
    if (window.dynamicChallengeEngine && window.dynamicChallengeEngine.evidenceFiles) {
        try {
            const content = window.dynamicChallengeEngine.evidenceFiles.get(filename);
            if (content) {
                // Create download
                const blob = new Blob([content], { type: 'text/plain' });
                const url = window.URL.createObjectURL(blob);
                const a = document.createElement('a');
                a.href = url;
                a.download = filename;
                document.body.appendChild(a);
                a.click();
                document.body.removeChild(a);
                window.URL.revokeObjectURL(url);
                
                // Update terminal
                if (window.terminalEngine) {
                    window.terminalEngine.addOutput(`[INFO] Evidence file ${filename} loaded successfully.`);
                    window.terminalEngine.addOutput('[INFO] Use terminal commands to examine the data.');
                }
                
                // Success visual feedback
                if (statusSpan) {
                    statusSpan.textContent = ' ‚úÖ';
                    evidenceLink.style.opacity = '1';
                    evidenceLink.style.background = 'linear-gradient(135deg, rgba(0, 255, 65, 0.2), rgba(0, 204, 52, 0.2))';
                    evidenceLink.style.borderColor = '#00ff41';
                }
            }
        } catch (error) {
            console.error('Dynamic download failed:', error);
            // Reset on error
            if (statusSpan) {
                statusSpan.textContent = ' ‚ùå';
                setTimeout(() => statusSpan.textContent = ' ‚¨áÔ∏è', 2000);
            }
        }
    } else {
        // Fallback method
        const basePath = window.location.pathname.replace(/\/modules\/[^\/]*$/, '');
        const evidenceUrl = `${basePath}/assets/data/scenarios/space-pirate-password-breach/${filename}`;
        
        fetch(evidenceUrl)
            .then(response => response.text())
            .then(content => {
                // Create download
                const blob = new Blob([content], { type: 'text/plain' });
                const url = window.URL.createObjectURL(blob);
                const a = document.createElement('a');
                a.href = url;
                a.download = filename;
                document.body.appendChild(a);
                a.click();
                document.body.removeChild(a);
                window.URL.revokeObjectURL(url);
                
                // Update terminal
                if (window.terminalEngine) {
                    window.terminalEngine.addOutput(`[INFO] Evidence file ${filename} loaded successfully.`);
                    window.terminalEngine.addOutput('[INFO] Use terminal commands to examine the data.');
                }
                
                // Success visual feedback
                if (statusSpan) {
                    statusSpan.textContent = ' ‚úÖ';
                    evidenceLink.style.opacity = '1';
                    evidenceLink.style.background = 'linear-gradient(135deg, rgba(0, 255, 65, 0.2), rgba(0, 204, 52, 0.2))';
                    evidenceLink.style.borderColor = '#00ff41';
                }
            })
            .catch(error => {
                console.error('Fallback download failed:', error);
                // Reset on error
                if (statusSpan) {
                    statusSpan.textContent = ' ‚ùå';
                    evidenceLink.style.opacity = '1';
                    setTimeout(() => statusSpan.textContent = ' ‚¨áÔ∏è', 2000);
                }
            });
    }
}
</script>